# Input Processing 模块与弹簧刚度矩阵分析

## 提问

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1752652674586-280f42c5-5232-4628-aa6d-1b4f471bb85c.png" alt="Input Processing 模块图">
</div>

进一步地，这个图是输入处理(Input Processing)模块内部的simulink构造，要求你分析一下图中每一个模块功能以及各自的输入输出的含义

## 回答

下面按功能模块分组，逐一说明各子模块的作用及其主要输入／输出含义。

---

### 1. 相对速度处理（Relative Velocity）

```
[5] Current Speed (m/s) ─┐
[6] Current Direction (rad) ─┐
[7] X (状态向量) ────────────┐
                         ┌───────────────┐
                         │ Relative      │───► [1] Relative Velocity (ν_r)
                         │  Velocity     │
                         └───────────────┘
```

+ **Current Speed、Current Direction**：环境水流的大小和方向。
+ **X**：船体当前六自由度状态向量（包括线速度 u,v,w）。
+ **Relative Velocity 子系统**：先将(水流速+方向)变换到船体坐标系，得到水体速度向量 $V_c$，再用船体速度 $\nu$ 减去 $V_c$，计算出相对水体的速度 $\nu_r$。
+ **输出** $\nu_r$：后续所有水动力、波浪、推力都基于它来计算。

---

### 2. 排水量与重心修正（Displacement & CG）

```
[1] Payload Mass (kg) ────┐      ┌─────────────┐
                          │      │ Volume      │───► [Volume (m³)]
[4] Water Density (kg/m³) ─┘      └─────────────┘

[1] Payload Mass (kg) ────┐      ┌───────────────────┐
                          │      │ CG corrected for  │───► [r_g] （修正后重心位置，m）
[2] Payload Location (m) ─┘      └───────────────────┘
```

1. **Volume**：
    - $m_p$（Payload Mass）＋模块内预设的船体质量，共同除以 $\rho$，得到排水体积 V。
    - **输出 V**：用于浮力、刚度、吃水计算。

2. **CG corrected for payload**：
    - 根据载荷质量与其在船体纵向（surge）方向上的位置 $t_p$，修正整体重心位置：

$$
r_g = \frac{m_h r_{g_h} + m_p t_p}{m_h + m_p}
$$

+ **输出** $r_g$：后续惯性矩阵和静水矩阵都要用到重心位置。

---

### 3. 从 CG 到参考原点（CO）的坐标变换

```
[r_g] ────────────┐
                  │      ┌───────────────────┐
[H]───────────────┘      │ Transform CG to CO │───► [5] r (CO 坐标系下的 CG)
                         └───────────────────┘
```

+ **Transform CG to CO**：
    - 输入修正后重心向量 $r_g$，以及内部预设的变换矩阵 **H**（从 CG 点到坐标原点 CO 的平移/旋转），
    - 输出在 CO 坐标系下的重心位置 **r**。

---

### 4. 刚体质量矩阵与水动力附加质量

```
[1] Payload Mass ─┐
                 │      ┌──────────────┐       ┌─────────────────┐
                 └───►  │   MRB_CG     │───►Aᵀ│ Matrix Multiply │──► [M]  ─► 再输出到 Inertials
                        └──────────────┘       └─────────────────┘
                           rigid‐body           (Aᵀ·MRB_CG·A)
                            inertia at CG              ↳ [4] total mass m_p

[2] Payload Location ─┐
[1] Payload Mass ─────┼────────────────────────────────────────────────►┐
                      │                                                 │
                      │   ┌───────────────────────────────────────────┐ │
                      └──►│ Inertial Matrix (hull+payload) in CO      │ │──► [3] Inertial Matrix (hull+payload) in CO
                          ├───────────────────────────────────────────┤ │
                          │ Added Mass (Hydrodynamics)                │ │──► [6] Added Mass Matrix MA
                          └───────────────────────────────────────────┘ │
                                                                    └─►► 供后续水动力、恢复力等使用
```

1. **MRB_CG**
    - 根据船体固有质心处的惯性矩（预设）与载荷质量 $m_p$，构建 6×6 刚体惯性矩阵 $M_{RB\_CG}$。

2. **Matrix Multiply** $(A^T \cdot M_{RB\_CG} \cdot A)$
    - 用第 3 步得到的平移／旋转矩阵 A，将惯性矩阵从 CG 点移到坐标原点 CO，得到刚体质量惯性矩阵 **M**。
    - 同时输出总质量 $m_p$ （供 Inertials 汇总）。

3. **Inertial Matrix (hull+payload) in CO & Added Mass**
    - 在同一子系统中，
        * **Inertial Matrix…**：也可选用简化公式直接根据载荷位置和质量算出的刚体惯性矩阵。
        * **Added Mass (Hydrodynamics)**：基于船体流线型、水密度及水动力特性，给出水动力附加质量矩阵 $M_A$。
    - **输出**：惯性矩阵（CO） [#3] 和附加质量矩阵 $M_A$ [#6]，供六自由度动力学方程使用。

---

### 5. 静水恢复力（Spring Stiffness）在 CO

```
[LCF]      ┐
[  0 ]     ├─► Transform CF to CO ──► [H2]
[r (CF)]   ┘                         └─► 与下游矩阵相乘

[4] Water Density (kg/m³) ┐
[3] Gravity (m/s²)        ├──►┐
[ T ] Draft (m)           ├──►│
[ V ] Volume (m³)         ├──►│   ┌────────┐   ┌───────────────┐
[ r_g ] CG (m)            └──►│   │  G_CF  │──▶│ Matrix Multiply│──► [7] G (in CO)
                                └──▶│ (in CF)│   └───────────────┘
                                   └────────┘
```

1. **Transform CF to CO**
    - 将浮力中心（CF）坐标系下的恢复矩阵变换到 CO 系。

2. $G_{CF}$ **(Spring Stiffness in CF)**
    - 基于 $\rho g V$ (浮力)、重心位置 $r_g$ 与吃水 T，计算船体在俯仰、横摇、纵荡的静水刚度：
        * $G_{33}$（heave）、$G_{44}$（roll）、$G_{55}$（pitch）分量。
    - 输出对角矩阵 $G_{CF}$。

3. **Matrix Multiply**
    - 用 H2 将 $G_{CF}$ 从 CF 转到 CO，得到最终的**静水刚度矩阵 G** [#7]。

---

### 6. 自振频率 & 吃水（Natural Frequencies & Draft）

```
[G33] ┐
[G44] ├─► Natural Frequencies ─► [8] ω₃, ω₄, ω₅
[G55] ├                        （heave/roll/pitch）
[ M ] ┘

[V] Volume (m³) ──► Draft ─► [9] T (m)
```

1. **Natural Frequencies**
    - 输入各维度的刚度（$G_{33}$/$G_{44}$/$G_{55}$）与对应惯性（M 或 $M_A$），
    - 计算三大模态的固有角频率 $\omega = \sqrt{G / M}$。

2. **Draft**
    - 根据排水体积 V 和已知水线面几何（模块内部），反算吃水深度 T。

---

这样，Input Processing 子系统就将环境参数、载荷质量／位置、船体几何与物理特性，依次转化为仿真所需的：

+ **相对速度** $\nu_r$
+ **排水体积** V
+ **修正重心** $r_g$
+ **刚体惯性矩阵** M、附加质量矩阵 $M_A$
+ **静水刚度矩阵** G
+ **固有频率** $\omega_3, \omega_4, \omega_5$
+ **吃水** T

——供后续 Thrust、Hydrodynamics、Hydrostatic、6DOF 等子系统直接使用。

---

## 继续追问

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1755158950651-c9ce3024-2dc6-4058-a877-2cf7588a8591.png" alt="Simulink接线图">
</div>

<img width="1581" height="490" alt="image" src="https://github.com/user-attachments/assets/24d99a21-bd15-4517-a52c-4a392687c151" />


这是Simulink的接线，它是无人水面艇的动力学Simulink模型的一部分。分析一下框出来的这个输出的表达式

## 回答

根据这个Simulink模型图，框出来的输出"Spring Stiffness Matrix in CO"（标记为7）的表达式可以分析如下：

### 表达式推导

$$G_{CO} = A^T \times G_{CF}$$

其中：

#### 1. 坐标变换矩阵 A

+ 由"Transform CF to CO"模块生成
+ 输入：LCF（局部坐标系参数）和0
+ 输出：变换矩阵A，然后取转置 $A^T$

#### 2. CF坐标系下的弹簧刚度矩阵 $G_{CF}$

$G_{CF}$ 由以下参数构成：

+ **rho**: 水密度 (kg/m³)
+ **g**: 重力加速度 (m/s²)
+ **nabla**: 排水体积 (m³)
+ **GM_T**: 横向稳心高度 (m)
+ **GM_L**: 纵向稳心高度 (m)
+ **G33, G44, G55**: 特定的刚度系数

#### 3. 物理意义

这个矩阵表示无人水面艇在CO坐标系（可能是原点坐标系或船体固定坐标系）下的**静水回复力刚度矩阵**，用于描述：

+ 垂荡（heave）回复力
+ 横摇（roll）回复力矩
+ 纵摇（pitch）回复力矩

#### 4. 数学形式

最终的6×6刚度矩阵大致形式为：

$$G_{CO} = A^T \times \text{diag}[0, 0, \rho g \nabla, \rho g \nabla GM_T, \rho g \nabla GM_L, 0] \times A$$

这种坐标变换确保了刚度矩阵能正确反映船体在目标坐标系下的静水回复特性。

---

## 继续提问

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1755158987176-306ad79e-1e5e-4421-ab62-8bdbc9b37150.png" alt="G_CF构建图">
</div>

再通过我上传的新图，分析一下 $G_{CF}$ 的表达式，以及如何通过Simulink实现的

## 回答

根据这个新的Simulink图，可以清楚地看到 $G_{CF}$（船体坐标系下的弹簧刚度矩阵）的构建过程：

### $G_{CF}$ 表达式分析

#### 1. 计算过程

从图中可以看到以下计算步骤：

**基础浮力项：**

$$\rho g \nabla = \rho \times g \times \nabla$$

**刚度矩阵对角元素：**

+ $G_{33} = \rho g \nabla \times 2 \times A_{w\_pont}$ (垂荡刚度)
+ $G_{44} = \rho g \nabla \times GM_T$ (横摇刚度)
+ $G_{55} = \rho g \nabla \times GM_L$ (纵摇刚度)

#### 2. 矩阵构建

通过Mux模块将计算得到的刚度系数组合，然后通过**diag**模块构建6×6对角矩阵：

$$G_{CF} = \text{diag}([0, 0, G_{33}, G_{44}, G_{55}, 0])$$

即：

$$G_{CF} = \text{diag}([0, 0, \rho g \nabla \times 2 \times A_{w\_pont}, \rho g \nabla \times GM_T, \rho g \nabla \times GM_L, 0])$$

#### 3. Simulink实现方式

1. **输入处理**：
    - $\rho$、$g$、$\nabla$ 通过乘法器串联
    - $GM_T$、$GM_L$ 分别与 $\rho g \nabla$ 相乘

2. **增益模块**：
    - "$2 \times A_{w\_pont}$"增益用于垂荡刚度计算
    - $A_{w\_pont}$ 可能表示水线面面积

3. **矩阵组装**：
    - Mux模块收集所有刚度系数
    - diag模块生成最终的6×6对角刚度矩阵

#### 4. 物理意义

+ $G_{33}$：垂荡方向的静水回复刚度
+ $G_{44}$：横摇方向的静水回复刚度
+ $G_{55}$：纵摇方向的静水回复刚度
+ 纵荡(surge)、横荡(sway)、艏摇(yaw)方向刚度为0

这种实现方式清晰地展现了船舶静水回复力矩阵的物理构成和数值计算过程。

---

## 继续提问

弹簧刚度矩阵是什么意思？还有simulink这里面nabla是不是指排开水的体积？

## 回答

### 弹簧刚度矩阵的含义

**"弹簧刚度矩阵"在船舶动力学中是一个比喻性的称呼，实际上指的是静水回复力矩阵或恢复力矩阵**。

#### 1. 物理机制

当船舶偏离平衡位置时：

+ **垂荡**：船体下沉时，浮力增大，向上推；上浮时，浮力减小，向下拉
+ **横摇**：船体倾斜时，浮心偏移产生回复力矩
+ **纵摇**：船体俯仰时，同样产生回复力矩

这种"偏离→回复力"的关系类似于弹簧的**胡克定律**：

$$F = -kx \quad \text{(力与位移成正比)}$$

#### 2. 数学表达

$$F_{\text{restoring}} = -G_{CF} \times \eta$$

其中：

+ $F_{\text{restoring}}$：静水回复力/力矩向量
+ $G_{CF}$：刚度矩阵
+ $\eta$：位置/姿态偏移向量

#### 3. 矩阵结构

$$G_{CF} = \text{diag}([0, 0, \rho g \nabla \times 2 \times A_w, \rho g \nabla \times GM_T, \rho g \nabla \times GM_L, 0])$$

+ 前两个0：纵荡、横荡无静水回复力
+ $G_{33}$：垂荡回复刚度
+ $G_{44}$：横摇回复刚度
+ $G_{55}$：纵摇回复刚度
+ 最后0：艏摇无静水回复力矩

### 关于nabla（$\nabla$）

**是的！nabla确实指排开水的体积**

#### 船舶术语中的 $\nabla$：

+ $\nabla$ = **排水体积**（Displacement Volume）
+ 单位：立方米 (m³)
+ 物理意义：船舶排开的水的体积

#### 相关概念：

+ **排水量** = $\rho \times \nabla$（质量，单位：吨）
+ **浮力** = $\rho \times g \times \nabla$（力，单位：牛顿）

#### 阿基米德原理：

$$\text{浮力} = \text{排开液体的重量} = \rho_{\text{water}} \times g \times \nabla$$

所以在Simulink模型中：

+ $\rho g \nabla$ = 船舶受到的总浮力
+ 这是计算所有静水回复力的基础

这就是为什么所有刚度系数（$G_{33}$、$G_{44}$、$G_{55}$）都包含 $\rho g \nabla$ 这一项的原因。

---

## 惯性矩阵分析

### 提问

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1766109555658-b7fe4386-a718-4ae8-ae6f-298662c2f6b0.png" alt="惯性矩阵总览图">
</div>

我的惯性矩阵是从这里来的（见截图），帮我分析一下矩阵的表达式，以及Simulink构成此惯性矩阵的机理。

### 回答

这张图非常关键，它把 yaw 动力学的一切"量级问题"都串起来了。下面分两部分说明：

1. 把惯性矩阵在数学上写成明确的表达式
2. 逐块解释 Simulink 是如何一步步构造这个惯性矩阵的

---

#### 一、最终结果的数学形式（核心）

这个模块最终输出的是 **6 自由度刚体 + 附加质量的惯性矩阵（在 CO 坐标系）**：

$$M = M_{RB}^{CO} + M_A$$

其中：

+ $M_{RB}^{CO}$：**刚体惯性矩阵（含船体 + payload），表达在 CO 坐标系**
+ $M_A$：**附加质量矩阵（Hydrodynamics）**

而之前用到的 $I_{zz}$，正是：

$$I_{zz} = \left(M_{RB}^{CO}\right)_{66}$$

也就是 **第 6 行第 6 列**。

---

#### 二、刚体惯性矩阵 $M_{RB}$ 的标准物理表达式

在船舶/海洋机器人（Fossen 体系）中，刚体惯性矩阵的标准形式是：

$$M_{RB} = \begin{bmatrix} m I_3 & -m S(r_g) \\ m S(r_g) & I_O \end{bmatrix}$$

其中：

+ $m = m_h + m_p$：船体 + payload 的总质量
+ $r_g$：**总质心相对于参考原点（CO）的位移**
+ $S(\cdot)$：叉乘（反对称）矩阵
+ $I_O$：**绕参考点 CO 的转动惯量张量**

而这个 $I_O$，是通过 **平行轴定理** 算出来的：

$$I_O = I_G + m \cdot S(r_g)^T S(r_g)$$

---

#### 三、Simulink 结构逐块解释

下面逐块解释图里的每一部分。

---

##### 1️⃣ 左下角：`Inertial Matrix (hull and payload) in CO`

**作用**：计算刚体惯性矩阵 $M_{RB}^{CO}$

**输入**：
+ `Payload Mass (kg)` → $m_p$
+ `Payload Location (m)` → $r_p$

**内部在做什么（物理上）**：

1. 先在 **各自质心坐标系**下，组合：
    - 船体惯量 $I_{h,G}$
    - payload 惯量 $I_{p,G}$
2. 计算合成质心：

$$r_g = \frac{m_h r_h + m_p r_p}{m_h + m_p}$$

3. 用 **平行轴定理**，把转动惯量从质心挪到 CO：

$$I_O = I_G + m S(r_g)^T S(r_g)$$

**这一步是 yaw 惯量被"放大"的根源**——只要 payload 在横向/纵向离中心远一点，$I_{zz}$ 会显著增大。

---

##### 2️⃣ 中上：`MRB_CG → Transform from CG to CO`

图中这一段：

```
MRB_CG → Aᵀ → Matrix Multiply → MRB
```

**物理意义**：坐标变换

+ 有些惯性是在 **CG 坐标系**下更容易写
+ 但 6DOF 动力学统一在 **CO 坐标系**

所以用了：

$$M_{RB}^{CO} = A^T M_{RB}^{CG} A$$

其中 $A$ 是 **6×6 坐标变换矩阵**（包含平移和旋转）。

---

##### 3️⃣ 中下：`Added Mass (Hydrodynamics)`

**输出**：$M_A$（附加质量矩阵）

这部分是：
+ 水体被加速所等效出来的惯性
+ 对 yaw 来说，对应的是 $N_{\dot r}$

---

##### 4️⃣ 右侧合并：`M = MRB + MA`

图中这一步非常清楚：

$$M = M_{RB}^{CO} + M_A$$

然后通过 Bus/Vector 形式输出：
+ `[M]` → 给 6DOF 积分器用
+ `Inertials` → 给阻尼、控制等模块用

---

#### 四、$I_{zz}$ 是怎么"变大"的？

结合这个结构，**yaw 惯量变大的路径只有三条**：

---

##### ① payload 位置 $r_p$ 偏离 CO（最常见、最容易被忽略）

通过平行轴定理：

$$I_{zz} = I_{zz,G} + m(x_g^2 + y_g^2)$$

只要 payload：
+ 横向偏一点
+ 或纵向偏一点

$I_{zz}$ 会按 **质量 × 距离²** 增长，这会直接放大：

$$N_r = \frac{I_{zz}}{T_{\text{yaw}}}$$

---

##### ② 附加质量 $M_A$ 中的 yaw 项

如果后面用的是：

$$M^{-1} \tau$$

那么即使阻尼只用了 $I_{zz}$，**真实的 yaw 响应**仍然会被 $M_A$ 改变。

---

##### ③ CO 选点不在"直觉中心"

如果 CO 选在：
+ 船头
+ 某个结构点
+ 而不是几何中心 / 质心附近

平行轴项会进一步放大 yaw 惯量。

---

### 深入分析：惯性矩阵的 Simulink 计算模块

#### 提问

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1766109675998-b5535676-6b50-4420-aac2-b12aea31727f.png" alt="惯性矩阵计算模块">
</div>

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1766109690527-e7c58c1c-2c37-46ae-950e-87d2e750a8c2.png" alt="Smtrx模块">
</div>

<div align="center">
  <img src="https://cdn.nlark.com/yuque/0/2025/png/2408029/1766109699369-f1957adb-4e00-42df-9c7e-dc14c3272fe1.png" alt="Smtrx1模块">
</div>

这个好像才是惯性矩阵的 Simulink 计算模块，其中的 Smtrx 和 Smtrx1 都上传了。分析一下机理。

#### 回答

这一组图**正好把"惯性矩阵是怎么在 Simulink 里被严格按物理公式算出来的"彻底摊开了**。这一步其实已经深入到 **Fossen 刚体惯性矩阵 + 平行轴定理** 的核心实现层了。

---

#### 一、先给结论版：这个模块在算什么（一句话）

这个模块在 **严格实现下面这条公式**（在 CO 坐标系）：

$$I_O = I_{CG} + m_h \cdot S(r_g)^\top S(r_g) + m_p \cdot S(r_p)^\top S(r_p)$$

其中：

+ $I_{CG}$：**船体本身在质心 CG 下的转动惯量**
+ $r_g$：船体 CG 到 CO 的位置向量
+ $r_p$：payload 到 CO 的位置向量
+ $S(\cdot)$：叉乘（反对称）矩阵
+ $m_h$：船体质量
+ $m_p$：payload 质量

而 `Smtrx` 和 `Smtrx1`，干的事情只有一件：

**把一个 3×1 向量 $r$，变成叉乘矩阵 $S(r)$**

---

#### 二、Smtrx / Smtrx1：到底在算什么？（逐像素对照）

Smtrx、Smtrx1 两张图，本质上**一模一样**，只是输入不同：

+ `Smtrx`：用的是 **船体 CG 位移** `rg`
+ `Smtrx1`：用的是 **payload 位移** `rp`

##### 1️⃣ Smtrx 输入是什么？

输入端口 `a` 是一个 **3×1 向量**：

$$a = \begin{bmatrix} x \\ y \\ z \end{bmatrix}$$

---

##### 2️⃣ Smtrx 内部在构造什么矩阵？

它在构造标准的 **反对称矩阵（skew-symmetric matrix）**：

$$S(a) = \begin{bmatrix} 0 & -z & y \\ z & 0 & -x \\ -y & x & 0 \end{bmatrix}$$

可以直接对照图里的连线：

+ `A11 = 0`
+ `A12 = -a(3)`
+ `A13 = a(2)`
+ `A21 = a(3)`
+ `A22 = 0`
+ `A23 = -a(1)`
+ `A31 = -a(2)`
+ `A32 = a(1)`
+ `A33 = 0`

图里那些 **"-1"增益块 + 总线拆分**，就是在干这件事。

> 这是 100% 教科书级的叉乘矩阵实现，没有任何"经验项"。

---

##### 3️⃣ 为什么要构造这个矩阵？

因为物理上：

$$S(r) \cdot v = r \times v$$

而平行轴定理在矩阵形式下，恰恰用的是：

$$S(r)^\top S(r)$$

---

#### 三、回到最外层：Simulink 是怎么一步步拼出惯性矩阵的？

沿着第一张"总图"从左到右走。

---

##### 1️⃣ `Inertial Matrix in CG`（左上）

这是 **船体本体在 CG 坐标系下的惯性张量**：

$$I_{CG} = \begin{bmatrix} I_{xx} & 0 & 0 \\ 0 & I_{yy} & 0 \\ 0 & 0 & I_{zz} \end{bmatrix}$$

（通常假设对角）

---

##### 2️⃣ 第一条平移项：船体 CG → CO（Smtrx + m）

这一支：

```
rg → Smtrx → Matrix Multiply → × m
```

对应数学式：

$$m_h \cdot S(r_g)^\top S(r_g)$$

这是 **船体自身的平行轴修正项**。

> 注意：即便 payload = 0，**只要 CG ≠ CO，yaw 惯量也会被放大**。

---

##### 3️⃣ 第二条平移项：payload → CO（Smtrx1 + mp）

这一支：

```
rp → Smtrx1 → Matrix Multiply → × mp
```

对应：

$$m_p \cdot S(r_p)^\top S(r_p)$$

这是 **payload 对惯性矩阵的贡献**。

> 这一项是 $I_{zz}$ 变大的最常见来源。

---

##### 4️⃣ 最右侧 Sum：三项相加

图里最右边那个竖着的大 "+ / −" 汇总块，干的就是：

$$I_O = I_{CG} + m_h S(r_g)^\top S(r_g) + m_p S(r_p)^\top S(r_p)$$

输出的 `Ig`，就是 **在 CO 坐标系下的转动惯量矩阵**。

---

#### 四、这和 yaw 问题是怎么"严丝合缝对上"的？

现在把关键因果链完整写出来：

1. **Smtrx / Smtrx1**
   → 实现平行轴定理

2. **payload 偏离 CO**
   → $I_{zz}$ 增大（∝ 质量 × 距离²）

3. **用 $N_r = I_{zz} / T_{yaw}$**
   → yaw 阻尼线性放大

4. **差速推进给一点偏航力矩**
   → 被"巨大阻尼"立刻压制

5. **结果看起来像"原地转 / 走不动"**

这是一条**完全自洽、完全不需要"玄学调参"的物理链路**。

---

#### 五、一个非常重要但常被忽略的结论

**Smtrx / Smtrx1 本身没有任何"保守/激进"的设计**——它们是"物理正确到不能再正确"的模块。

真正决定系统性格的是：

+ CO 选在哪里
+ payload 放在哪里
+ $T_{yaw}$ 怎么选
+ yaw 阻尼是不是又叠加了速度放大项

---

#### 六、总结

通过以上分析，已经做了三件**非常硬核的事**：

1. 没停留在"调参数"，而是**追到惯性矩阵的构造**
2. 没停留在"某个模块"，而是**看完整物理链条**
3. 把 Simulink 的连线 **一一翻译成数学公式**

到这一步，已经不是"用模型的人"，而是"**知道模型在干什么的人**"。

